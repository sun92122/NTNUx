import{t as g,v as i,x as o,y as n,z as c,M as _,N as y,A as t,B as f,J as e,K as G,L,P as H,H as k,r as S,Q as I,R as r,o as j,I as P,S as Q,T as W,U as V,V as J,W as K,X as x,Y as B,Z as X,$ as Y}from"./5czFQKUz.js";import{u as Z}from"./BXFwBR2F.js";import b from"./CADAb-lV.js";import ee from"./BICZgBtr.js";import le from"./CE82cs-C.js";import ae from"./CU2TXf2A.js";import se from"./CeQYx3DJ.js";import te from"./D_j3bg-N.js";import oe from"./kE5xJoIw.js";import"./DPTNcLUY.js";import"./jegaPh3T.js";const re={class:"course-row"},ue={class:"course-cell course-code"},ce={class:"course-cell course-title"},ie={class:"course-name"},ne=["href"],de={class:"message-group"},me={class:"course-cell"},ve={class:"message-group"},fe={class:"course-cell course-comment"},he={key:0},be={key:1},ge={__name:"courseCell",props:{course:{type:Object,required:!0}},setup(l){const w={必:"必修",選:"選修",通:"通識"},C={A1UG:"人文藝術",A2UG:"社會科學",A3UG:"自然科學",A4UG:"邏輯運算",B1UG:"學院共同課程",B2UG:"跨域專業探索課程",B3UG:"大學入門",C1UG:"專題探究",C2UG:"MOOCs"};return(O,$)=>(i(),g("div",re,[o("div",ue,[o("span",null,n(l.course.serial_no),1),o("span",null,n(l.course.course_code),1)]),o("div",ce,[o("span",ie,[o("a",{href:`https://courseap2.itc.ntnu.edu.tw/acadmOpenCourse/SyllabusCtrl?year=${l.course.acadm_year}&term=${l.course.acadm_term}&courseCode=${l.course.course_code}&courseGroup=${l.course.course_group}&deptCode=${l.course.dept_code}&formS=${l.course.form_s}&classes1=${l.course.classes}&deptGroup=${l.course.dept_group_name}`,target:"_blank"},n(l.course.course_name),9,ne)]),o("div",de,[c(e(b),{icon:"pi pi-building",severity:"secondary",class:"custom-message"},{default:t(()=>[f(n(l.course.dept_chiabbr),1)]),_:1}),c(e(b),{icon:"pi pi-user",severity:"secondary",class:"custom-message"},{default:t(()=>[f(n(l.course.teacher),1)]),_:1}),l.course.time?(i(),_(e(b),{key:0,icon:"pi pi-clock",severity:l.course.time.match(/.* 1[-/$]/)?"warn":"secondary",class:"custom-message"},{default:t(()=>[f(n(l.course.time),1)]),_:1},8,["severity"])):y("",!0),l.course.location?(i(),_(e(b),{key:1,icon:"pi pi-map-marker",severity:"secondary",class:"custom-message"},{default:t(()=>[f(n(l.course.location),1)]),_:1})):y("",!0)])]),o("div",me,[o("div",ve,[c(e(b),{icon:"pi pi-tag",severity:"secondary",class:"custom-message"},{default:t(()=>[f(n(w[l.course.option_code]||l.course.option_code),1)]),_:1}),l.course.generalCore?(i(!0),g(G,{key:0},L(l.course.generalCore.split("/"),A=>(i(),_(e(b),{key:A,icon:"pi pi-tag",severity:"secondary",class:"custom-message"},{default:t(()=>[f(n(C[A]||A),1)]),_:2},1024))),128)):y("",!0),c(e(b),{icon:"pi pi-book",severity:"secondary",class:"custom-message"},{default:t(()=>[f(n(Math.floor(l.course.credit))+" 學分",1)]),_:1}),c(e(b),{icon:"pi pi-users",severity:"secondary",class:"custom-message"},{default:t(()=>[f(n(`${l.course.limit_count_h} 人`),1)]),_:1}),l.course.eng_teach==="是"?(i(),_(e(b),{key:1,severity:"error",class:"custom-message"},{default:t(()=>$[0]||($[0]=[f("英文授課")])),_:1})):y("",!0)])]),o("div",fe,[l.course.restrict?(i(),g("span",he,n(l.course.restrict.replace(/<\/br>/g,`
`).replace(new RegExp("(?<=.)◎","g"),`
◎`)),1)):y("",!0),l.course.comment?(i(),g("span",be,n(l.course.comment.replace(/<\/br>/g,`
`)),1)):y("",!0)])]))}},pe={class:"tabs-container"},ye={class:"container"},_e={class:"search-container search-bar"},Ce={key:0,for:"globalFilter"},$e={key:1,for:"globalFilter"},Ae={key:0,class:"search-input multi-search-input-sub-filter"},Ne={class:"grid-container"},Me=null,Le={__name:"index",setup(l){const w=W(),C=P(),O=H(),{currentTerm:$,rowData:A,loading:q,initTermData:R,defultGlobalFilterFields:F}=Z(),z=k("updateMenubar"),U=k("selectedCourses",()=>({})),M=k("selectedRows",()=>({})),N=k("isShowAdvancedSearch",()=>!1),h=S(""),m=S({value:null,filter_field:null,select_list:[],label:null}),d=S({global:{value:Me,matchMode:r.CONTAINS},option_code:{value:null,matchMode:r.EQUALS},course_name:{value:null,matchMode:r.CONTAINS},chn_name:{value:null,matchMode:r.CONTAINS},dept_chiabbr:{value:null,matchMode:r.CONTAINS},eng_teach:{value:null,matchMode:r.EQUALS},generalCore:{operator:I.OR,constraints:[]},dept_code:{operator:I.OR,constraints:[]}}),T=S({quick:{label:"快速搜尋",value:"quick",command:()=>v({})},advanced:{label:"進階搜尋",value:"advanced",command:()=>{N.value=!0,v({global:null})}},general:{label:"通識",value:"general",command:()=>v({option_code:"通"},{label:"選擇通識領域",select_list:[{label:"人文藝術",value:{value:"A1UG",matchMode:r.CONTAINS}},{label:"社會科學",value:{value:"A2UG",matchMode:r.CONTAINS}},{label:"自然科學",value:{value:"A3UG",matchMode:r.CONTAINS}},{label:"邏輯運算",value:{value:"A4UG",matchMode:r.CONTAINS}},{label:"學院共同課程",value:{value:"B1UG",matchMode:r.CONTAINS}},{label:"跨域專業探索課程",value:{value:"B2UG",matchMode:r.CONTAINS}},{label:"大學入門",value:{value:"B3UG",matchMode:r.CONTAINS}},{label:"專題探究",value:{value:"C1UG",matchMode:r.CONTAINS}},{label:"MOOCs",value:{value:"C2UG",matchMode:r.CONTAINS}}],filter_field:"generalCore"})},physical:{label:"體育",activeLabel:"普通體育",value:"physical",command:()=>v({dept_chiabbr:"普通體育"})},defense:{label:"國防",activeLabel:"全民國防教育",value:"defense",command:()=>v({chn_name:"全民國防"})},interschool:{label:"校際",activeLabel:"臺大系統校際課程",value:"interschool",command:()=>v({dept_chiabbr:"校際"},{label:"選擇開課學校",select_list:[{label:"國立臺灣大學",value:{value:"AA",matchMode:r.ENDS_WITH}},{label:"國立臺灣科技大學",value:{value:"AB",matchMode:r.ENDS_WITH}}],filter_field:"dept_code"})},program:{label:"學分學程",value:"program",command:()=>v({chn_name:"學分學程"})},english:{label:"英文三",value:"english",command:()=>v({course_name:"英文（三）"})},emi:{label:"英文授課",value:"emi",command:()=>v({eng_teach:"是"})},"":{label:"",value:"quick",command:()=>v({})}});j(async()=>{var u,a;await R(C),z.value(),h.value=((u=C.query.m)==null?void 0:u.toLowerCase())||"quick",T.value[h.value]?(a=T.value[h.value])==null||a.command():h.value="quick",U.value[$.value]||(U.value[$.value]={}),M.value=U.value[$.value]}),Q(()=>h.value,u=>{w.replace({path:C.path,query:{...C.query,m:u,s:d.value.global.value||null}})});function v(u,a=null){var s;for(const p in d.value)p!=="global"&&(p in u?d.value[p].value=u[p]:(d.value[p].value=null,(s=d.value[p]).constraints&&(s.constraints=[])));a?m.value={...m.value,value:null,filter_field:a.filter_field,select_list:a.select_list,label:a.label}:m.value.filter_field=null}function D(){N.value=!0}function E(u){const a=M.value;a[u.serial_no]?(delete a[u.serial_no],O.add({severity:"info",summary:"已取消選課",detail:`${u.serial_no} ${u.course_name}`,life:3e3})):(a[u.serial_no]=u,O.add({severity:"success",summary:"已選課",detail:`${u.serial_no} ${u.course_name}`,life:3e3}))}return(u,a)=>(i(),g(G,null,[o("div",pe,[c(e(ae),{value:h.value,"onUpdate:value":a[0]||(a[0]=s=>h.value=s),scrollable:""},{default:t(()=>[c(e(ee),null,{default:t(()=>[(i(!0),g(G,null,L(Object.values(T.value),s=>(i(),_(e(le),{key:s.value,value:s.value,onClick:p=>s.command?s.command():null,class:V(s.label?"":"tab-disabled")},{default:t(()=>[f(n(h.value==s.value&&s.activeLabel||s.label),1)]),_:2},1032,["value","onClick","class"]))),128))]),_:1})]),_:1},8,["value"])]),o("div",ye,[o("div",_e,[c(e(se),{variant:"in",class:V(["search-input",m.value.filter_field?"multi-search-input-main-filter":"single-search-input"]),onClick:a[3]||(a[3]=s=>e(N)?D():null)},{default:t(()=>[c(e(J),null,{default:t(()=>[c(e(K),null,{default:t(()=>a[6]||(a[6]=[o("i",{class:"pi pi-search"},null,-1)])),_:1}),e(N)?(i(),_(e(x),{key:1,id:"globalFilter",modelValue:d.value.global.value,"onUpdate:modelValue":a[2]||(a[2]=s=>d.value.global.value=s),autocapitalize:!1,size:"large",style:{width:"100%",cursor:"pointer"}},null,8,["modelValue"])):(i(),_(e(x),{key:0,id:"globalFilter",modelValue:d.value.global.value,"onUpdate:modelValue":a[1]||(a[1]=s=>d.value.global.value=s),autocapitalize:!1,size:"large",style:{width:"100%"}},null,8,["modelValue"]))]),_:1}),e(N)?(i(),g("label",$e,"進階搜尋")):(i(),g("label",Ce,"課程名稱/教師/開課序號"))]),_:1},8,["class"]),m.value.filter_field?(i(),g("div",Ae,[c(e(te),{id:"sub-filter",modelValue:m.value.value,"onUpdate:modelValue":a[4]||(a[4]=s=>m.value.value=s),options:m.value.select_list,optionLabel:"label",optionValue:"value",style:{width:"100%"},showClear:!0,showToggleAll:!1,showFilter:!0,placeholder:m.value.label,display:"chip",onChange:a[5]||(a[5]=s=>{d.value[m.value.filter_field].constraints=s.value||[{value:null,matchMode:e(r).CONTAINS}]})},null,8,["modelValue","options","placeholder"])])):y("",!0)]),o("div",Ne,[c(e(Y),{value:e(A),paginator:!0,filters:d.value,"global-filter-fields":h.value.filter_field||e(F),showGridlines:!1,"show-headers":!1,scrollable:!0,scrollHeight:"calc(100vh - 20rem)",rows:50,rowsPerPageOptions:[10,20,50,100],loading:e(q),style:{border:"1px solid var(--p-datatable-border-color)",borderRadius:"0.5rem"}},{header:t(()=>a[7]||(a[7]=[o("span",null,"課程資訊",-1)])),loading:t(()=>[c(e(oe),{width:"100%",height:"100%",shape:"rectangle","border-radius":"0.5rem"})]),empty:t(()=>a[8]||(a[8]=[o("div",{class:"flex align-items-center justify-content-center"},[o("i",{class:"pi pi-exclamation-triangle mr-2"}),o("span",null,"沒有符合條件的課程")],-1)])),default:t(()=>[c(e(B),{sortable:!1},{body:t(({data:s})=>[c(e(ge),{course:s},null,8,["course"])]),_:1}),c(e(B),{headerStyle:{width:"5rem",textAlign:"center"},bodyStyle:{textAlign:"center"},sortable:!1,style:{width:"5rem",textAlign:"center",paddingRight:"1rem"},header:""},{body:t(({data:s})=>[c(e(X),{label:e(M)[s.serial_no]?"取消":"加入",severity:e(M)[s.serial_no]?"warn":"secondary",onClick:p=>E(s)},null,8,["label","severity","onClick"])]),_:1})]),_:1},8,["value","filters","global-filter-fields","loading"])])])],64))}};export{Le as default};
