import{H as u}from"./C3tVsWYY.js";function j(){const a=u("terms",()=>[]),e=u("currentTerm",()=>null),l=u("loadTermData"),s=u("rowDatas",()=>({})),n=u("rowData",()=>[]),c=u("loading",()=>!0),v=["course_name","teacher","serial_no"],m=async o=>{const t=await fetch(`data/${e.value}/${o}.min.json`);if(!t.ok)return null;const i=await t.json();return i.length===0?null:i.map(r=>({...r,credit:Math.round(r.credit*10)/10,course_name:r.chn_name.replace(/<\/br>.*/g,""),time:p(r.time_loc),location:w(r.time_loc),teacher:h(r.teacher),generalCore:r.generalCore.join("/")}))},d=async()=>{const o=[];for(let t=0;t<10;t++)o.push(m(t));for await(const t of o)t&&(n.value=n.value.concat(t),c.value=!1)},f=async()=>{if(c.value=!0,s.value[e.value]){n.value=s.value[e.value],c.value=!1;return}n.value=[],await d(),s.value[e.value]=n.value};return{terms:a,currentTerm:e,rowData:n,loading:c,reloadCurrentTerm:f,defultGlobalFilterFields:v,initTermData:async o=>{if(a.value.length>0){c.value=!1;return}const i=await(await fetch("/data/terms.json")).json();a.value=i.terms,e.value=o.query.term,(!e.value||a.value.indexOf(e.value)===-1)&&(e.value=i.defaultValue),l.value=f,await f()}}}function h(a){return a.replace("","温")}function p(a){return typeof a=="string"?a:Object.entries(a).map(([e,l])=>e).join("/")}function w(a){if(typeof a=="string")return null;const e=Object.values(a).filter(s=>s!==""),l=[...new Set(e)];return l.length===1?l[0]:e.join("/")}export{j as u};
