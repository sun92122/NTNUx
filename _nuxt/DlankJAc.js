import z from"./B7lEqf52.js";import I from"./oGk6ajVR.js";import{_ as q,r as w,t as b,v as p,x as e,z as n,H as F,I as A,y as i,B as d,J as s,K as L,A as m,L as G,M as P,m as H,N,o as U,O as J,P as K}from"./fA5QhvbU.js";import Q from"./BFSWzv7v.js";import W from"./DXOIr9Ps.js";import X from"./qF-LYeRt.js";import Y from"./Cjt96Lj3.js";import"./DnQjWatj.js";import"./DBQKQZye.js";import Z from"./Bs_er44Y.js";import ee from"./CEZScXsN.js";import te from"./BxkLfgor.js";import oe from"./BtbKnilW.js";import"./BLol8AtI.js";import se from"./az2htlgJ.js";import C from"./Bsj522a9.js";import"./CgZ1kLF2.js";import"./Cekj0FYd.js";import"./DegrWjAw.js";import"./B4G_XLv5.js";import"./BwliGYSr.js";import"./4cAGSIg6.js";import"./EzWH5STg.js";import"./CR9iYkFB.js";import"./HVe_yRRB.js";import"./DegYBl0P.js";import"./BsrewgYa.js";import"./DZ5AKTLX.js";import"./Cv0fqmi3.js";import"./DQ6kn_Xq.js";import"./DUAwsePF.js";import"./yW4RCcyx.js";import"./Cdj4BQjH.js";import"./B01ri10c.js";import"./DZoAi6K8.js";import"./CtodWDxw.js";import"./DKiCZmOO.js";import"./BtGQ1s09.js";import"./BxgSCPkw.js";import"./DHGHlgAB.js";import"./Dl3LsSS1.js";const le={class:"schedule-box"},ae={class:"timetable"},re={class:"row header-row"},ce={class:"cell time-cell"},ne={__name:"FloatingSchedule",props:{selectedRows:{type:Array,default:()=>[]}},setup(o){const B=o,x=["一","二","三","四","五"],k=[{label:"0",time:"07:10 ~ 08:00"},{label:"1",time:"08:10 ~ 09:00"},{label:"2",time:"09:10 ~ 10:00"},{label:"3",time:"10:20 ~ 11:10"},{label:"4",time:"11:20 ~ 12:10"},{label:"5",time:"12:20 ~ 13:10"},{label:"6",time:"13:20 ~ 14:10"},{label:"7",time:"14:20 ~ 15:10"},{label:"8",time:"15:30 ~ 16:20"},{label:"9",time:"16:30 ~ 17:20"},{label:"10",time:"17:30 ~ 18:20"},{label:"A",time:"18:30 ~ 19:25"},{label:"B",time:"19:35 ~ 20:25"},{label:"C",time:"20:30 ~ 21:20"},{label:"D",time:"21:25 ~ 22:15"}];function $(l){const a=[];if(typeof l!="object"||!l)return a;for(const t of Object.keys(l)){const v=t.match(/([一二三四五])\s*(\d+|A|B|C|D)(?:-(\d+|A|B|C|D))?/);if(v){const[y,_,E,O]=v,c=M(E,O||E);for(const r of c)a.push({day:_,period:r,loc:l[t]})}}return a}function M(l,a){const t=["0","1","2","3","4","5","6","7","8","9","10","A","B","C","D"],v=t.indexOf(l),y=t.indexOf(a);return t.slice(v,y+1)}const g=w({});function j(){g.value={};for(const l of B.selectedRows){const a=$(l.time_loc||"");for(const t of a)g.value[t.day]||(g.value[t.day]={}),g.value[t.day][t.period]||(g.value[t.day][t.period]=[]),g.value[t.day][t.period].push({...l,loc:t.loc})}}j();const D=w({});function R(l){const a=["#FFDD57","#87CEEB","#FF7F7F","#90EE90","#DDA0DD","#FFA07A","#00CED1","#F4A460","#B0E0E6","#FFB6C1"],t=Array.from(l).reduce((v,y)=>v+y.charCodeAt(0),0);return a[t%a.length]}function S(l){return l in D.value||(D.value[l]=R(l)),D.value[l]}w(null);const f=w([{label:"顏色",icon:"pi pi-palette",command:l=>{}}]);return(l,a)=>(p(),b(F,null,[e("div",le,[e("div",ae,[e("div",re,[a[0]||(a[0]=e("div",{class:"cell time-cell"},null,-1)),(p(),b(F,null,A(x,t=>e("div",{key:t,class:"cell"},i(t),1)),64))]),(p(),b(F,null,A(k,t=>e("div",{key:t.label,class:"row"},[e("div",ce,[d(i(t.label),1),a[1]||(a[1]=e("br",null,null,-1)),e("small",null,i(t.time),1)]),(p(),b(F,null,A(x,v=>{var y;return e("div",{key:v,class:"cell"},[(p(!0),b(F,null,A(((y=s(g)[v])==null?void 0:y[t.label])||[],_=>(p(),b("div",{key:_.serial_no,class:"course-block",style:L({backgroundColor:S(_.serial_no)})},[d(i(_.chn_name.replace(/<\/?br>/g," "))+" ",1),a[2]||(a[2]=e("br",null,null,-1)),d(" "+i(_.teacher)+" ",1),a[3]||(a[3]=e("br",null,null,-1)),d(" "+i(_.loc),1)],4))),128))])}),64))])),64))])]),n(s(se),{model:s(f),direction:"up",style:{position:"absolute",right:"-2.5rem",bottom:"1.5rem"},buttonProps:{severity:"secondary",rounded:!0},tooltipOptions:{position:"left"}},null,8,["model"])],64))}},ie=q(ne,[["__scopeId","data-v-105c7701"]]),ue={class:"course-row"},me={class:"course-cell course-code"},de={class:"course-cell course-title"},pe={class:"course-name"},fe=["href"],ve={class:"message-group"},be={class:"course-cell"},he={class:"message-group"},ge={class:"course-cell"},ye={key:0,class:"course-comment"},_e={key:1,class:"course-comment"},we={__name:"CourseCell",props:{course:{type:Object,required:!0}},setup(o){const B={必:"必修",選:"選修",通:"通識"};return(x,k)=>(p(),b("div",ue,[e("div",me,[e("span",null,i(o.course.serial_no),1),e("span",null,i(o.course.course_code),1)]),e("div",de,[e("span",pe,[e("a",{href:`https://courseap2.itc.ntnu.edu.tw/acadmOpenCourse/SyllabusCtrl?year=${o.course.acadm_year}&term=${o.course.acadm_term}&courseCode=${o.course.course_code}&courseGroup=${o.course.course_group}&deptCode=${o.course.dept_code}&formS=${o.course.form_s}&classes1=${o.course.classes}&deptGroup=${o.course.dept_group_name}`,target:"_blank"},i(o.course.course_name),9,fe)]),e("div",ve,[n(s(C),{icon:"pi pi-building",severity:"secondary",class:"custom-message"},{default:m(()=>[d(i(o.course.dept_chiabbr),1)]),_:1}),n(s(C),{icon:"pi pi-user",severity:"secondary",class:"custom-message"},{default:m(()=>[d(i(o.course.teacher),1)]),_:1}),n(s(C),{icon:"pi pi-clock",severity:"secondary",class:"custom-message"},{default:m(()=>[d(i(o.course.time),1)]),_:1}),n(s(C),{icon:"pi pi-map-marker",severity:"secondary",class:"custom-message"},{default:m(()=>[d(i(o.course.location),1)]),_:1})])]),e("div",be,[e("div",he,[n(s(C),{icon:"pi pi-tag",severity:"secondary",class:"custom-message"},{default:m(()=>[d(i(B[o.course.option_code]||o.course.option_code),1)]),_:1}),n(s(C),{icon:"pi pi-book",severity:"secondary",class:"custom-message"},{default:m(()=>[d(i(Math.floor(o.course.credit))+" 學分",1)]),_:1}),n(s(C),{icon:"pi pi-users",severity:"secondary",class:"custom-message"},{default:m(()=>[d(i(`${o.course.limit_count_h} 人`),1)]),_:1}),o.course.eng_teach==="是"?(p(),G(s(C),{key:0,severity:"error",class:"custom-message"},{default:m(()=>k[0]||(k[0]=[d("英文授課")])),_:1})):P("",!0)])]),e("div",ge,[o.course.restrict?(p(),b("span",ye,i(o.course.restrict.replace(/<\/br>/g,`
`).replace(new RegExp("(?<=.)◎","g"),`
◎`)),1)):P("",!0),o.course.comment?(p(),b("span",_e,i(o.course.comment.replace(/<\/br>/g,`
`)),1)):P("",!0)])]))}},$e={class:"tabs-container"},Ce={class:"container"},ke={class:"search-container"},De={class:"grid-container"},pt={__name:"index",setup(o){const x=H().public.isCloudflare,k=N("terms",()=>[]),$=N("currentTerm",()=>null),M=N("loadTermData"),g=N("updateMenubar");U(async()=>{const c=await fetch("data/terms.json");k.value=await c.json(),$.value=k.value[0],M.value=E,M.value()});const j=J(null),D=w({global:{value:null,matchMode:K.CONTAINS}}),R=w(!1),S=w({}),f=w([]),l=w([]),a=async c=>(await fetch("data/"+$.value+"_"+c+".min.json")).json(),t=async()=>(await fetch("data/"+$.value+".min.json")).json();function v(c){return c.replace("","温")}function y(c){const r=[];for(const[u,T]of Object.entries(c)){const[h,V]=u.split(" ");r.push(`${h} ${V}`)}return r.join("/")}function _(c){const r=[];for(const[T,h]of Object.entries(c))h!==""&&r.push(h);const u=[...new Set(r)];return u.length===1?u[0]:r.join("/")}const E=async()=>{if(S.value[$.value]){f.value=S.value[$.value];return}if(f.value=[],l.value=[],x)f.value=await t();else{const r=(await a(0)).total,u=[];for(let h=1;h<=r;h++)u.push(a(h));const T=await Promise.all(u);for(const h of T)f.value=f.value.concat(h)}f.value=f.value.map(c=>({...c,course_name:c.chn_name.replace(/<\/br>.*/g,""),time:y(c.time_loc),location:_(c.time_loc),teacher:v(c.teacher)})),S.value[$.value]=f.value,g.value()};function O(c){j.value&&(l.value=j.value.getSelectedRows())}return(c,r)=>(p(),b(F,null,[e("div",$e,[n(s(W),{value:"quick",scrollable:""},{default:m(()=>[n(s(Y),null,{default:m(()=>[(p(),b(F,null,A([{label:"快速搜尋",value:"quick"},{label:"通識",value:"general"},{label:"共同",value:"common"},{label:"國防",value:"國防"},{label:"體育",value:"physical"},{label:"校際",value:"interschool"},{label:"學分學程",value:"program"},{label:"英文授課",value:"EMI"},{label:"英文三",value:"english"}],u=>n(s(X),{key:u.value,label:u.label,value:u.value},{default:m(()=>[d(i(u.label),1)]),_:2},1032,["label","value"])),64))]),_:1})]),_:1})]),e("div",Ce,[e("div",ke,[n(s(Z),{variant:"in",class:"search-bar"},{default:m(()=>[n(s(ee),null,{default:m(()=>[n(s(te),null,{default:m(()=>r[2]||(r[2]=[e("i",{class:"pi pi-search"},null,-1)])),_:1}),n(s(oe),{id:"globalFilter",modelValue:D.value.global.value,"onUpdate:modelValue":r[0]||(r[0]=u=>D.value.global.value=u),autocapitalize:!1,size:"large",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),r[3]||(r[3]=e("label",{for:"globalFilter"},"課程名稱/教師/開課序號",-1))]),_:1})]),e("div",De,[n(s(z),{value:f.value,paginator:!0,filters:D.value,"global-filter-fields":["course_name","teacher","serial_no"],showGridlines:!0,"show-headers":!1,scrollable:!0,scrollHeight:"80vh",rows:50,rowsPerPageOptions:[10,20,50,100],onSelectionChange:O},{header:m(()=>r[4]||(r[4]=[e("span",null,"課程資訊",-1)])),default:m(()=>[n(s(I),{sortable:!1},{body:m(({data:u})=>[n(s(we),{course:u},null,8,["course"])]),_:1})]),_:1},8,["value","filters"])])]),n(s(Q),{visible:R.value,"onUpdate:visible":r[1]||(r[1]=u=>R.value=u),maximizable:"",modal:"",header:"Header",style:{width:"50rem",height:"80vh"},"content-style":{margin:"0 0 1rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:m(()=>[n(s(ie),{selectedRows:l.value},null,8,["selectedRows"])]),_:1},8,["visible"])],64))}};export{pt as default};
