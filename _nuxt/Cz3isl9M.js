import{_ as T,D as y,r as w,o as z,E,F as L,v as p,A as f,G as O,H as r,y as i,z as a,B as v,I as U,x as u,J as _,C as W,K as N,L as $}from"./Dt7xPlWn.js";import{u as Y}from"./BCJsK1af.js";import{_ as j}from"./BndGkQO9.js";import F from"./CfFA2fKW.js";import P from"./BYPsfL1v.js";import A from"./DENjCraX.js";import G from"./DoXa-Q73.js";import"./DCORhbU6.js";import"./BNYfMsHz.js";import"./DlI_uBe-.js";import"./Dw0BR8Sl.js";import"./DjtmS3jT.js";import"./DGh7caCU.js";import"./DanPGV3o.js";import"./CMHzprb9.js";import"./CaSzWbCS.js";import"./BEzJdIf1.js";const H={class:"container"},J={key:1,class:"container"},K={style:{marginBottom:0}},R={class:"card-container"},q={style:{margin:"0"}},Q={key:0,style:{"text-align":"center"}},X={key:0},Z={key:1},ee={style:{"text-align":"center"}},te={key:0},se={key:1},oe={class:"p-d-flex p-ai-center"},ne={style:{margin:"0"}},ie={style:{whiteSpace:"break-spaces",marginTop:"0.5rem"},class:"p-card-subtitle"},re={key:0,style:{"margin-top":"8rem"}},le=["href"],ae={__name:"home",setup(ce){const M=E(),{initTermData:V}=Y(),C=y("updateMenubar"),D=y("routerLoading",()=>!1),o=y("courseSelectionSchedule",()=>{}),d=w(1),I=y("windowWidth",()=>window.innerWidth),S=w([{breakpoint:"100000px",numVisible:3,numScroll:1},{breakpoint:"745px",numVisible:1,numScroll:1}]);function B(){const s=new Date,t=s.getFullYear()-1911,l=s.getMonth()+1,n=s.getDate();for(const[g,c]of o.value.schedule.entries())if(c.date&&c.date.date){const[e,m,h]=c.date.date.split("/").map(Number);if(t>e||t===e&&l>m||t===e&&l===m&&n>h)continue;return g}else if(c.end&&c.end.date){const[e,m,h]=c.end.date.split("/").map(Number);if(t>e||t===e&&l>m||t===e&&l===m&&n>h)continue;return g}}function k(s,t,l){return Math.min(Math.max(s,t),l)}function x(s){d.value=k(s,0,o.value.schedule.length-3)}function b(){var t,l;const s=B();if(s!==void 0){d.value=k(s,1,o.value.schedule.length-1)-1;const n=o.value.schedule[s];U({title:"選課時程",description:`查看選課時程並快速搜尋課程。${n.info?`${n.info} ${((t=n==null?void 0:n.date)==null?void 0:t.date)||((l=n==null?void 0:n.start)==null?void 0:l.date)||""}`:""}`,keywords:"師大課程查詢, 師大課程, 師大選課, NTNU Course Search"})}}return z(async()=>{var s;(s=o==null?void 0:o.value)!=null&&s.schedule?b():await fetch("/data/schedule.json").then(t=>t.json()).then(t=>{o.value=t,b()}).catch(t=>{console.error("Error fetching course selection schedule:",t)}),await V(M),C.value()}),L(()=>{var s,t;return(t=(s=o==null?void 0:o.value)==null?void 0:s.schedule)==null?void 0:t.length},s=>{s>0&&b()}),(s,t)=>{var l,n,g,c;return u(),p("div",H,[f(r(j)),r(D)?(u(),O(r(F),{key:0,style:{"margin-top":"30vh","margin-bottom":"20vh"}})):(u(),p("div",J,[i("h3",K,a((l=r(o))==null?void 0:l.year)+" 學年度 第 "+a((n=r(o))==null?void 0:n.term)+" 學期 ",1),t[4]||(t[4]=i("h1",{class:"center"},"選課時程",-1)),f(r(G),{value:(g=r(o))==null?void 0:g.schedule,page:d.value,numVisible:r(I)<=745?1:3,numScroll:1,showNavigators:!1,showIndicators:!1,responsiveOptions:S.value,"onUpdate:page":t[0]||(t[0]=e=>d.value=e)},{item:v(({data:e,_:m})=>[i("div",R,[f(r(P),{class:"schedule-card"},{title:v(()=>[i("h3",q,a(e==null?void 0:e.info),1)]),subtitle:v(()=>[e!=null&&e.date?(u(),p("div",Q,[e.date.time?(u(),p("span",X,a(e.date.time),1)):_("",!0),i("span",{class:"card-title-date",style:N({color:e.color})},a(e.date.date),5)])):_("",!0),e.start?(u(),p("div",Z,[i("div",ee,[e.start.time?(u(),p("span",te,a(e.start.time),1)):_("",!0),i("span",{class:"card-title-date",style:N({color:e.color})},a(e.start.date)+"-"+a(e.end.date),5),e.end.time?(u(),p("span",se,a(e.end.time),1)):_("",!0)])])):_("",!0)]),content:v(()=>[f(r(A),{value:e==null?void 0:e.steps,align:"left",class:"p-mt-3"},{content:v(({item:h})=>[i("div",oe,[i("div",null,[i("h4",ne,a(h.title),1),i("div",ie,a(h.description),1)])])]),_:2},1032,["value"])]),footer:v(()=>[e!=null&&e.moreInfo?(u(),p("div",re,[i("a",{href:e.moreInfoUrl,target:"_blank",style:{color:"inherit","text-decoration":"none",cursor:"pointer"}},[t[3]||(t[3]=i("i",{class:"pi pi-external-link",style:{"margin-right":"1rem"}},null,-1)),W(" "+a(e.moreInfo),1)],8,le)])):_("",!0)]),_:2},1024)])]),_:1},8,["value","page","numVisible","responsiveOptions"]),i("div",null,[f(r($),{icon:"pi pi-angle-left",variant:"text",rounded:"",size:"large",onClick:t[1]||(t[1]=e=>x(d.value-1)),disabled:d.value<=0,style:{"margin-right":"0.5rem"}},null,8,["disabled"]),f(r($),{icon:"pi pi-angle-right",variant:"text",rounded:"",size:"large",onClick:t[2]||(t[2]=e=>x(d.value+1)),disabled:d.value>=((c=r(o))==null?void 0:c.schedule.length)-3},null,8,["disabled"])])]))])}}},Ve=T(ae,[["__scopeId","data-v-a4f1f080"]]);export{Ve as default};
