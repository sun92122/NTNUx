import{t as g,v as n,x as i,y as u,z as c,M as O,N as C,A as o,B as p,J as e,K as x,L as F,P,H as y,r as T,Q as m,o as Q,I as J,R as K,S as X,T as L,U as r,V as Y,W as Z,X as I,Y as q,Z as ee,$ as ae}from"./CItEfQ8r.js";import{u as le}from"./BKC5je1-.js";import b from"./DwaRlWdk.js";import te from"./BH4RWNi3.js";import se from"./CbhZhSnF.js";import oe from"./CDz1enT5.js";import re from"./d_YWS6d7.js";import ie from"./CYHkG2xg.js";import ce from"./k2sudpWp.js";import"./qWJJAN_1.js";import"./B7bIVjd6.js";const ne={class:"course-row"},ue={class:"course-cell course-code"},de={class:"course-cell course-title"},me={class:"course-name"},ve=["href"],fe={class:"message-group"},pe={class:"course-cell"},he={class:"message-group"},be={class:"course-cell course-comment"},ge={key:0},ye={key:1},_e={__name:"courseCell",props:{course:{type:Object,required:!0}},setup(l){const R={必:"必修",選:"選修",通:"通識"},$={A1UG:"人文藝術",A2UG:"社會科學",A3UG:"自然科學",A4UG:"邏輯運算",B1UG:"學院共同課程",B2UG:"跨域專業探索課程",B3UG:"大學入門",C1UG:"專題探究",C2UG:"MOOCs"};return(S,w)=>(n(),g("div",ne,[i("div",ue,[i("span",null,u(l.course.serial_no),1),i("span",null,u(l.course.course_code),1)]),i("div",de,[i("span",me,[i("a",{href:`https://courseap2.itc.ntnu.edu.tw/acadmOpenCourse/SyllabusCtrl?year=${l.course.acadm_year}&term=${l.course.acadm_term}&courseCode=${l.course.course_code}&courseGroup=${l.course.course_group}&deptCode=${l.course.dept_code}&formS=${l.course.form_s}&classes1=${l.course.classes}&deptGroup=${l.course.dept_group_name}`,target:"_blank"},u(l.course.course_name),9,ve)]),i("div",fe,[c(e(b),{icon:"pi pi-building",severity:"secondary",class:"custom-message"},{default:o(()=>[p(u(l.course.dept_chiabbr),1)]),_:1}),c(e(b),{icon:"pi pi-user",severity:"secondary",class:"custom-message"},{default:o(()=>[p(u(l.course.teacher),1)]),_:1}),l.course.time?(n(),O(e(b),{key:0,icon:"pi pi-clock",severity:l.course.time.match(/.* (0|1)([-/\n\r]|$)/)?"warn":"secondary",class:"custom-message"},{default:o(()=>[p(u(l.course.time),1)]),_:1},8,["severity"])):C("",!0),l.course.location?(n(),O(e(b),{key:1,icon:"pi pi-map-marker",severity:"secondary",class:"custom-message"},{default:o(()=>[p(u(l.course.location),1)]),_:1})):C("",!0)])]),i("div",pe,[i("div",he,[c(e(b),{icon:"pi pi-tag",severity:"secondary",class:"custom-message"},{default:o(()=>[p(u(R[l.course.option_code]||l.course.option_code),1)]),_:1}),l.course.generalCore?(n(!0),g(x,{key:0},F(l.course.generalCore.split("/"),k=>(n(),O(e(b),{key:k,icon:"pi pi-tag",severity:"secondary",class:"custom-message"},{default:o(()=>[p(u($[k]||k),1)]),_:2},1024))),128)):C("",!0),c(e(b),{icon:"pi pi-book",severity:"secondary",class:"custom-message"},{default:o(()=>[p(u(l.course.credit)+" 學分",1)]),_:1}),c(e(b),{icon:"pi pi-users",severity:l.course.limit_count_h>0?"secondary":"warn",class:"custom-message"},{default:o(()=>[p(u(`${l.course.limit_count_h} 人`),1)]),_:1},8,["severity"]),l.course.eng_teach==="是"?(n(),O(e(b),{key:1,severity:"error",class:"custom-message"},{default:o(()=>w[0]||(w[0]=[p("英文授課")])),_:1})):C("",!0)])]),i("div",be,[l.course.restrict?(n(),g("span",ge,u(l.course.restrict.replace(/<\/br>/g,`
`).replace(new RegExp("(?<=.)◎","g"),`
◎`)),1)):C("",!0),l.course.comment?(n(),g("span",ye,u(l.course.comment.replace(/<\/br>/g,`
`)),1)):C("",!0)])]))}},Ce={class:"tabs-container"},Oe={class:"container"},$e={class:"search-container search-bar"},we={key:0,class:"global-filter-label",for:"globalFilter"},ke={key:1,class:"global-filter-label advanced-search-label",for:"globalFilter"},Ae={key:0,class:"search-input multi-search-input-sub-filter"},Re={class:"grid-container"},Se=null,Fe={__name:"index",setup(l){const R=X(),$=J(),S=P(),{currentTerm:w,rowData:k,loading:z,initTermData:D,defultGlobalFilterFields:j}=le(),W=y("updateMenubar"),M=y("selectedCourses",()=>({})),A=y("selectedRows",()=>({})),U=y("isShowAdvancedSearch",()=>!1),V=y("windowWidth",()=>window.innerWidth),E=y("advancedSearchDisplayValue",()=>"點擊進行進階搜尋"),G=y("advancedSearchRebuildFunction"),d=T(""),v=T({value:null,filter_field:null,select_list:[],label:null}),h=y("filters",()=>({global:{value:Se,matchMode:m.CONTAINS},option_code:{operator:r.OR,constraints:[]},course_name:{operator:r.OR,constraints:[]},chn_name:{operator:r.OR,constraints:[]},dept_chiabbr:{operator:r.OR,constraints:[]},eng_teach:{operator:r.OR,constraints:[]},generalCore:{operator:r.OR,constraints:[]},dept_code:{operator:r.OR,constraints:[]},time_inf:{operator:r.OR,constraints:[]},time_loc:{operator:r.OR,constraints:[]},timeListStr:{operator:r.OR,constraints:[]},comment:{operator:r.OR,constraints:[]},credit:{operator:r.OR,constraints:[]}})),N=T({quick:{label:"快速搜尋",value:"quick",command:()=>f({})},advanced:{label:"進階搜尋",value:"advanced",command:()=>{U.value=!0,f({}),h.value.global.value=null,G&&G.value&&G.value()}},general:{label:"通識",value:"general",command:()=>f({option_code:{operator:r.OR,constraints:[{value:"通",matchMode:m.EQUALS}]}},{label:"選擇通識領域",select_list:Object.entries({人文藝術:"A1UG",社會科學:"A2UG",自然科學:"A3UG",邏輯運算:"A4UG",學院共同課程:"B1UG",跨域專業探索課程:"B2UG",大學入門:"B3UG",專題探究:"C1UG",MOOCs:"C2UG"}).map(([s,a])=>({label:s,value:{value:a,matchMode:m.CONTAINS}})),filter_field:"generalCore"})},physical:{label:"體育",activeLabel:"普通體育",value:"physical",command:()=>f({dept_chiabbr:{operator:r.OR,constraints:[{value:"體育",matchMode:m.CONTAINS}]}})},defense:{label:"國防",activeLabel:"全民國防教育",value:"defense",command:()=>f({chn_name:{operator:r.OR,constraints:[{value:"全民國防",matchMode:m.CONTAINS}]}})},interschool:{label:"校際",activeLabel:"臺大系統校際課程",value:"interschool",command:()=>f({dept_chiabbr:{operator:r.OR,constraints:[{value:"校際",matchMode:m.CONTAINS}]}},{label:"選擇開課學校",select_list:Object.entries({國立臺灣大學:"AA",國立臺灣科技大學:"AB"}).map(([s,a])=>({label:s,value:{value:a,matchMode:m.ENDS_WITH}})),filter_field:"dept_code"})},program:{label:"學分學程",value:"program",command:()=>f({chn_name:{operator:r.OR,constraints:[{value:"學分學程",matchMode:m.CONTAINS}]}})},english:{label:"英文三",value:"english",command:()=>f({course_name:{operator:r.OR,constraints:[{value:"英文（三）",matchMode:m.CONTAINS}]}})},emi:{label:"英文授課",value:"emi",command:()=>f({eng_teach:{operator:r.OR,constraints:[{value:"是",matchMode:m.EQUALS}]}})},"":{label:"",value:"quick",command:()=>f({})}});Q(async()=>{var s,a;await D($),W.value(),d.value=((s=$.query.m)==null?void 0:s.toLowerCase())||"quick",N.value[d.value]?(a=N.value[d.value])==null||a.command():d.value="quick",M.value[w.value]||(M.value[w.value]={}),A.value=M.value[w.value]}),K(()=>d.value,s=>{R.replace({path:$.path,query:{...$.query,m:s,s:h.value.global.value||null}})});function f(s,a=null){var t;for(const _ in h.value)_!=="global"&&(_ in s?h.value[_]=s[_]:(t=h.value[_]).constraints&&(t.constraints=[]));a?v.value={...v.value,value:null,filter_field:a.filter_field,select_list:a.select_list,label:a.label}:v.value.filter_field=null}function B(){U.value=!0}function H(s){const a=A.value;a[s.serial_no]?(delete a[s.serial_no],S.add({severity:"info",summary:"已取消選課",detail:`${s.serial_no} ${s.course_name}`,life:3e3,group:V.value<768?"bottom":null})):(a[s.serial_no]=s,S.add({severity:"success",summary:"已選課",detail:`${s.serial_no} ${s.course_name}`,life:3e3,group:V.value<768?"bottom":null}))}return(s,a)=>(n(),g(x,null,[i("div",Ce,[c(e(oe),{value:d.value,"onUpdate:value":a[0]||(a[0]=t=>d.value=t),scrollable:""},{default:o(()=>[c(e(te),null,{default:o(()=>[(n(!0),g(x,null,F(Object.values(N.value),t=>(n(),O(e(se),{key:t.value,value:t.value,onClick:_=>t.command?t.command():null,class:L(t.label?"":"tab-disabled")},{default:o(()=>[p(u(d.value==t.value&&t.activeLabel||t.label),1)]),_:2},1032,["value","onClick","class"]))),128))]),_:1})]),_:1},8,["value"])]),i("div",Oe,[i("div",$e,[c(e(re),{variant:"in",class:L(["search-input",v.value.filter_field?"multi-search-input-main-filter":"single-search-input"]),onClick:a[2]||(a[2]=t=>e(U)?B():null)},{default:o(()=>[c(e(Y),null,{default:o(()=>[c(e(Z),null,{default:o(()=>a[5]||(a[5]=[i("i",{class:"pi pi-search"},null,-1)])),_:1}),d.value!="advanced"?(n(),O(e(I),{key:0,id:"globalFilter",modelValue:e(h).global.value,"onUpdate:modelValue":a[1]||(a[1]=t=>e(h).global.value=t),autocapitalize:!1,size:"large",style:{width:"100%"}},null,8,["modelValue"])):(n(),O(e(I),{key:1,id:"globalFilter",value:"",readonly:"",autocapitalize:!1,size:"large",style:{width:"100%",cursor:"pointer"},onClick:B}))]),_:1}),d.value!="advanced"?(n(),g("label",we,"課程名稱/教師/開課序號")):(n(),g("label",ke,u(e(E)||"點擊進行進階搜尋"),1))]),_:1},8,["class"]),v.value.filter_field?(n(),g("div",Ae,[c(e(ie),{id:"sub-filter",modelValue:v.value.value,"onUpdate:modelValue":a[3]||(a[3]=t=>v.value.value=t),options:v.value.select_list,optionLabel:"label",optionValue:"value",style:{width:"100%"},showClear:!0,showToggleAll:!1,showFilter:!0,placeholder:v.value.label,display:"chip",onChange:a[4]||(a[4]=t=>{e(h)[v.value.filter_field].constraints=t.value||[{value:null,matchMode:e(m).CONTAINS}]})},null,8,["modelValue","options","placeholder"])])):C("",!0)]),i("div",Re,[c(e(ae),{value:e(k),paginator:!0,filters:e(h),"global-filter-fields":d.value.filter_field||e(j),showGridlines:!1,"show-headers":!1,scrollable:!0,scrollHeight:"calc(100vh - 22rem)",rows:50,rowsPerPageOptions:[10,20,50,100],loading:e(z),style:{border:"1px solid var(--p-datatable-border-color)",borderRadius:"0.5rem"}},{header:o(()=>a[6]||(a[6]=[i("span",null,"課程資訊",-1)])),loading:o(()=>[c(e(ce),{width:"100%",height:"100%",shape:"rectangle","border-radius":"0.5rem"})]),empty:o(()=>a[7]||(a[7]=[i("div",{class:"flex align-items-center justify-content-center"},[i("i",{class:"pi pi-exclamation-triangle mr-2"}),i("span",null,"沒有符合條件的課程")],-1)])),default:o(()=>[c(e(q),{sortable:!1},{body:o(({data:t})=>[c(e(_e),{course:t},null,8,["course"])]),_:1}),c(e(q),{headerStyle:{width:"5rem",textAlign:"center"},bodyStyle:{textAlign:"center"},sortable:!1,style:{width:"5rem",textAlign:"center",paddingRight:"1rem"},header:""},{body:o(({data:t})=>[c(e(ee),{label:e(A)[t.serial_no]?"取消":"加入",severity:e(A)[t.serial_no]?"warn":"secondary",onClick:_=>H(t)},null,8,["label","severity","onClick"])]),_:1})]),_:1},8,["value","filters","global-filter-fields","loading"])])])],64))}};export{Fe as default};
