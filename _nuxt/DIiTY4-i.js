import{t as g,v as m,x as r,y as i,z as c,H as T,I as b,A as o,B as v,J as s,K as I,L,M as C,N as W,o as J,r as M,O as x,P as u,Q as B,R as K,S as X,T as Y,U as D,V as Z,W as ee}from"./C90GeY4M.js";import le from"./BZaexOcx.js";import ae from"./DkABw9Xn.js";import te from"./D9hL55sP.js";import se from"./BUT6g90i.js";import oe from"./BUKbErRh.js";import re from"./DFJWTAB8.js";import h from"./DPEDcHnd.js";import"./Dy5QDUtf.js";import"./O2-52HIV.js";const ne={class:"course-row"},ce={class:"course-cell course-code"},ue={class:"course-cell course-title"},ie={class:"course-name"},de=["href"],me={class:"message-group"},ve={class:"course-cell"},fe={class:"message-group"},he={class:"course-cell course-comment"},pe={key:0},be={key:1},ge={__name:"courseCell",props:{course:{type:Object,required:!0}},setup(a){const w={必:"必修",選:"選修",通:"通識"},p={A1UG:"人文藝術",A2UG:"社會科學",A3UG:"自然科學",A4UG:"邏輯運算",B1UG:"學院共同課程",B2UG:"跨域專業探索課程",B3UG:"大學入門",C1UG:"專題探究",C2UG:"MOOCs"};return(U,$)=>(m(),g("div",ne,[r("div",ce,[r("span",null,i(a.course.serial_no),1),r("span",null,i(a.course.course_code),1)]),r("div",ue,[r("span",ie,[r("a",{href:`https://courseap2.itc.ntnu.edu.tw/acadmOpenCourse/SyllabusCtrl?year=${a.course.acadm_year}&term=${a.course.acadm_term}&courseCode=${a.course.course_code}&courseGroup=${a.course.course_group}&deptCode=${a.course.dept_code}&formS=${a.course.form_s}&classes1=${a.course.classes}&deptGroup=${a.course.dept_group_name}`,target:"_blank"},i(a.course.course_name),9,de)]),r("div",me,[c(s(h),{icon:"pi pi-building",severity:"secondary",class:"custom-message"},{default:o(()=>[v(i(a.course.dept_chiabbr),1)]),_:1}),c(s(h),{icon:"pi pi-user",severity:"secondary",class:"custom-message"},{default:o(()=>[v(i(a.course.teacher),1)]),_:1}),a.course.time?(m(),T(s(h),{key:0,icon:"pi pi-clock",severity:a.course.time.match(/.* 1[-/$]/)?"warn":"secondary",class:"custom-message"},{default:o(()=>[v(i(a.course.time),1)]),_:1},8,["severity"])):b("",!0),a.course.location?(m(),T(s(h),{key:1,icon:"pi pi-map-marker",severity:"secondary",class:"custom-message"},{default:o(()=>[v(i(a.course.location),1)]),_:1})):b("",!0)])]),r("div",ve,[r("div",fe,[c(s(h),{icon:"pi pi-tag",severity:"secondary",class:"custom-message"},{default:o(()=>[v(i(w[a.course.option_code]||a.course.option_code),1)]),_:1}),a.course.generalCore?(m(!0),g(I,{key:0},L(a.course.generalCore.split("/"),y=>(m(),T(s(h),{key:y,icon:"pi pi-tag",severity:"secondary",class:"custom-message"},{default:o(()=>[v(i(p[y]||y),1)]),_:2},1024))),128)):b("",!0),c(s(h),{icon:"pi pi-book",severity:"secondary",class:"custom-message"},{default:o(()=>[v(i(Math.floor(a.course.credit))+" 學分",1)]),_:1}),c(s(h),{icon:"pi pi-users",severity:"secondary",class:"custom-message"},{default:o(()=>[v(i(`${a.course.limit_count_h} 人`),1)]),_:1}),a.course.eng_teach==="是"?(m(),T(s(h),{key:1,severity:"error",class:"custom-message"},{default:o(()=>$[0]||($[0]=[v("英文授課")])),_:1})):b("",!0)])]),r("div",he,[a.course.restrict?(m(),g("span",pe,i(a.course.restrict.replace(/<\/br>/g,`
`).replace(new RegExp("(?<=.)◎","g"),`
◎`)),1)):b("",!0),a.course.comment?(m(),g("span",be,i(a.course.comment.replace(/<\/br>/g,`
`)),1)):b("",!0)])]))}},ye={class:"tabs-container"},_e={class:"container"},Ce={class:"search-container search-bar"},$e={key:0,class:"search-input multi-search-input-sub-filter"},Ne={class:"grid-container"},xe={__name:"index",setup(a){const w=C("terms",()=>[]),p=C("currentTerm",()=>null),U=C("loadTermData"),$=C("updateMenubar"),y=W();J(async()=>{const e=await(await fetch("data/terms.json")).json();w.value=e.terms,p.value=w.value[e.defaultIndex],$.value(),U.value=H,U.value()});const d=M({value:null,filter_field:null,select_list:[],label:null}),N=M({global:{value:null,matchMode:u.CONTAINS},option_code:{value:null,matchMode:u.EQUALS},course_name:{value:null,matchMode:u.CONTAINS},chn_name:{value:null,matchMode:u.CONTAINS},dept_chiabbr:{value:null,matchMode:u.CONTAINS},eng_teach:{value:null,matchMode:u.EQUALS},generalCore:{operator:x.OR,constraints:[]},dept_code:{operator:x.OR,constraints:[]}}),V=["course_name","teacher","serial_no"],A=M(!0),G=C("rowDatas",()=>({})),_=M([]),O=C("selectedRows",()=>({})),k=M("quick"),j=[{label:"快速搜尋",value:"quick",command:()=>{f({})}},{label:"通識",value:"general",command:()=>{f({option_code:"通"},{label:"選擇通識領域",select_list:[{label:"人文藝術",value:{value:"A1UG",matchMode:u.CONTAINS}},{label:"社會科學",value:{value:"A2UG",matchMode:u.CONTAINS}},{label:"自然科學",value:{value:"A3UG",matchMode:u.CONTAINS}},{label:"邏輯運算",value:{value:"A4UG",matchMode:u.CONTAINS}},{label:"學院共同課程",value:{value:"B1UG",matchMode:u.CONTAINS}},{label:"跨域專業探索課程",value:{value:"B2UG",matchMode:u.CONTAINS}},{label:"大學入門",value:{value:"B3UG",matchMode:u.CONTAINS}},{label:"專題探究",value:{value:"C1UG",matchMode:u.CONTAINS}},{label:"MOOCs",value:{value:"C2UG",matchMode:u.CONTAINS}}],filter_field:"generalCore"})},filter_field:["course_name"]},{label:"體育",activeLabel:"普通體育",value:"physical",command:()=>{f({dept_chiabbr:"普通體育"})}},{label:"國防",activeLabel:"全民國防教育",value:"Defense",command:()=>{f({chn_name:"全民國防"})}},{label:"校際",activeLabel:"臺大系統校際課程",value:"interschool",command:()=>{f({dept_chiabbr:"校際"},{label:"選擇開課學校",select_list:[{label:"國立臺灣大學",value:{value:"AA",matchMode:u.ENDS_WITH}},{label:"國立臺灣科技大學",value:{value:"AB",matchMode:u.ENDS_WITH}}],filter_field:"dept_code"})}},{label:"學分學程",value:"program",command:()=>{f({chn_name:"學分學程"})}},{label:"英文三",value:"english",command:()=>{f({course_name:"英文（三）"})}},{label:"英文授課",value:"EMI",command:()=>{f({eng_teach:"是"})}},{label:"",value:"quick",command:()=>{f({})}}];function f(t,e=null){const l=N.value;for(const n in l)n!=="global"&&(n in t?l[n].value=t[n]:(l[n].value&&(l[n].value=null),l[n].constraints&&(l[n].constraints=[])));e?(d.value.value=null,d.value.filter_field=e.filter_field,d.value.select_list=e.select_list,d.value.label=e.label):d.value.filter_field=null}async function R(t){const e=await fetch(`data/${p.value}/${t}.min.json`);if(!e.ok)return null;const l=await e.json();return l.length===0?null:l.map(n=>({...n,course_name:n.chn_name.replace(/<\/br>.*/g,""),time:q(n.time_loc),location:z(n.time_loc),teacher:E(n.teacher),generalCore:n.generalCore.join("/")}))}async function F(){const t=[];for(let e=0;e<10;e++)t.push(R(e));for await(const e of t)e&&(_.value=_.value.concat(e),A.value=!1)}function E(t){return t.replace("","温")}function q(t){if(typeof t=="string")return t;const e=[];for(const[l,n]of Object.entries(t)){const[S,Q]=l.split(" ");e.push(`${S} ${Q}`)}return e.join("/")}function z(t){if(typeof t=="string")return null;const e=[];for(const[n,S]of Object.entries(t))S!==""&&e.push(S);const l=[...new Set(e)];return l.length===1?l[0]:e.join("/")}async function H(){if(A.value=!0,G.value[p.value]){_.value=G.value[p.value],A.value=!1;return}_.value=[],O.value={},await F().then(()=>{A.value=!1}),G.value[p.value]=_.value,$.value()}function P(t){const e=O.value;e[t.serial_no]?(delete e[t.serial_no],y.add({severity:"info",summary:"已取消選課",detail:`${t.serial_no} ${t.course_name}`,life:3e3})):(e[t.serial_no]=t,y.add({severity:"success",summary:"已選課",detail:`${t.serial_no} ${t.course_name}`,life:3e3}))}return(t,e)=>(m(),g(I,null,[r("div",ye,[c(s(ae),{value:k.value,"onUpdate:value":e[0]||(e[0]=l=>k.value=l),scrollable:""},{default:o(()=>[c(s(se),null,{default:o(()=>[(m(),g(I,null,L(j,l=>c(s(te),{key:l.value,value:l.value,onClick:n=>l.command?l.command():null,class:B(l.label?"":"tab-disabled")},{default:o(()=>[v(i(k.value==l.value&&l.activeLabel||l.label),1)]),_:2},1032,["value","onClick","class"])),64))]),_:1})]),_:1},8,["value"])]),r("div",_e,[r("div",Ce,[c(s(oe),{variant:"in",class:B(["search-input",d.value.filter_field?"multi-search-input-main-filter":"single-search-input"])},{default:o(()=>[c(s(K),null,{default:o(()=>[c(s(X),null,{default:o(()=>e[4]||(e[4]=[r("i",{class:"pi pi-search"},null,-1)])),_:1}),c(s(Y),{id:"globalFilter",modelValue:N.value.global.value,"onUpdate:modelValue":e[1]||(e[1]=l=>N.value.global.value=l),autocapitalize:!1,size:"large",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e[5]||(e[5]=r("label",{for:"globalFilter"},"課程名稱/教師/開課序號",-1))]),_:1},8,["class"]),d.value.filter_field?(m(),g("div",$e,[c(s(re),{id:"sub-filter",modelValue:d.value.value,"onUpdate:modelValue":e[2]||(e[2]=l=>d.value.value=l),options:d.value.select_list,optionLabel:"label",optionValue:"value",style:{width:"100%"},showClear:!0,showToggleAll:!1,showFilter:!0,placeholder:d.value.label,display:"chip",onChange:e[3]||(e[3]=l=>{N.value[d.value.filter_field].constraints=l.value||[{value:null,matchMode:s(u).CONTAINS}]})},null,8,["modelValue","options","placeholder"])])):b("",!0)]),r("div",Ne,[c(s(ee),{value:_.value,paginator:!0,filters:N.value,"global-filter-fields":k.value.filter_field||V,showGridlines:!1,"show-headers":!1,scrollable:!0,scrollHeight:"calc(100vh - 20rem)",rows:50,rowsPerPageOptions:[10,20,50,100],loading:A.value,style:{border:"1px solid var(--p-datatable-border-color)",borderRadius:"0.5rem"}},{header:o(()=>e[6]||(e[6]=[r("span",null,"課程資訊",-1)])),loading:o(()=>[c(s(le),{width:"100%",height:"100%",shape:"rectangle","border-radius":"0.5rem"})]),empty:o(()=>e[7]||(e[7]=[r("div",{class:"flex align-items-center justify-content-center"},[r("i",{class:"pi pi-exclamation-triangle mr-2"}),r("span",null,"沒有符合條件的課程")],-1)])),default:o(()=>[c(s(D),{sortable:!1},{body:o(({data:l})=>[c(s(ge),{course:l},null,8,["course"])]),_:1}),c(s(D),{headerStyle:{width:"5rem",textAlign:"center"},bodyStyle:{textAlign:"center"},sortable:!1,style:{width:"5rem",textAlign:"center",paddingRight:"1rem"},header:""},{body:o(({data:l})=>[c(s(Z),{label:s(O)[l.serial_no]?"取消":"加入",severity:s(O)[l.serial_no]?"warn":"secondary",onClick:n=>P(l)},null,8,["label","severity","onClick"])]),_:1})]),_:1},8,["value","filters","global-filter-fields","loading"])])])],64))}};export{xe as default};
