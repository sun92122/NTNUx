import{t as b,v as n,x as r,y as u,z as c,M as C,N as _,A as o,B as p,J as e,K as T,L,P as E,H as w,r as N,Q as d,o as H,I as P,R as Q,S as W,T as V,U as i,V as J,W as K,X as x,Y as B,Z as X,$ as Y}from"./C3tVsWYY.js";import{u as Z}from"./B3imOF3j.js";import g from"./POOepdcL.js";import ee from"./Btqp1dUt.js";import ae from"./2H6Q7tBp.js";import le from"./BCVqMapT.js";import te from"./Cd27hqOT.js";import se from"./BN6FqbeB.js";import oe from"./Bz5FiI-D.js";import"./BML0HPhE.js";import"./DRhIj2_b.js";const re={class:"course-row"},ie={class:"course-cell course-code"},ce={class:"course-cell course-title"},ne={class:"course-name"},ue=["href"],de={class:"message-group"},me={class:"course-cell"},ve={class:"message-group"},fe={class:"course-cell course-comment"},pe={key:0},he={key:1},ge={__name:"courseCell",props:{course:{type:Object,required:!0}},setup(l){const M={必:"必修",選:"選修",通:"通識"},$={A1UG:"人文藝術",A2UG:"社會科學",A3UG:"自然科學",A4UG:"邏輯運算",B1UG:"學院共同課程",B2UG:"跨域專業探索課程",B3UG:"大學入門",C1UG:"專題探究",C2UG:"MOOCs"};return(R,O)=>(n(),b("div",re,[r("div",ie,[r("span",null,u(l.course.serial_no),1),r("span",null,u(l.course.course_code),1)]),r("div",ce,[r("span",ne,[r("a",{href:`https://courseap2.itc.ntnu.edu.tw/acadmOpenCourse/SyllabusCtrl?year=${l.course.acadm_year}&term=${l.course.acadm_term}&courseCode=${l.course.course_code}&courseGroup=${l.course.course_group}&deptCode=${l.course.dept_code}&formS=${l.course.form_s}&classes1=${l.course.classes}&deptGroup=${l.course.dept_group_name}`,target:"_blank"},u(l.course.course_name),9,ue)]),r("div",de,[c(e(g),{icon:"pi pi-building",severity:"secondary",class:"custom-message"},{default:o(()=>[p(u(l.course.dept_chiabbr),1)]),_:1}),c(e(g),{icon:"pi pi-user",severity:"secondary",class:"custom-message"},{default:o(()=>[p(u(l.course.teacher),1)]),_:1}),l.course.time?(n(),C(e(g),{key:0,icon:"pi pi-clock",severity:l.course.time.match(/.* 1[-/$]/)?"warn":"secondary",class:"custom-message"},{default:o(()=>[p(u(l.course.time),1)]),_:1},8,["severity"])):_("",!0),l.course.location?(n(),C(e(g),{key:1,icon:"pi pi-map-marker",severity:"secondary",class:"custom-message"},{default:o(()=>[p(u(l.course.location),1)]),_:1})):_("",!0)])]),r("div",me,[r("div",ve,[c(e(g),{icon:"pi pi-tag",severity:"secondary",class:"custom-message"},{default:o(()=>[p(u(M[l.course.option_code]||l.course.option_code),1)]),_:1}),l.course.generalCore?(n(!0),b(T,{key:0},L(l.course.generalCore.split("/"),k=>(n(),C(e(g),{key:k,icon:"pi pi-tag",severity:"secondary",class:"custom-message"},{default:o(()=>[p(u($[k]||k),1)]),_:2},1024))),128)):_("",!0),c(e(g),{icon:"pi pi-book",severity:"secondary",class:"custom-message"},{default:o(()=>[p(u(l.course.credit)+" 學分",1)]),_:1}),c(e(g),{icon:"pi pi-users",severity:l.course.limit_count_h>0?"secondary":"warn",class:"custom-message"},{default:o(()=>[p(u(`${l.course.limit_count_h} 人`),1)]),_:1},8,["severity"]),l.course.eng_teach==="是"?(n(),C(e(g),{key:1,severity:"error",class:"custom-message"},{default:o(()=>O[0]||(O[0]=[p("英文授課")])),_:1})):_("",!0)])]),r("div",fe,[l.course.restrict?(n(),b("span",pe,u(l.course.restrict.replace(/<\/br>/g,`
`).replace(new RegExp("(?<=.)◎","g"),`
◎`)),1)):_("",!0),l.course.comment?(n(),b("span",he,u(l.course.comment.replace(/<\/br>/g,`
`)),1)):_("",!0)])]))}},be={class:"tabs-container"},ye={class:"container"},_e={class:"search-container search-bar"},Ce={key:0,for:"globalFilter"},$e={key:1,for:"globalFilter"},Oe={key:0,class:"search-input multi-search-input-sub-filter"},ke={class:"grid-container"},Ae=null,Le={__name:"index",setup(l){const M=W(),$=P(),R=E(),{currentTerm:O,rowData:k,loading:I,initTermData:q,defultGlobalFilterFields:F}=Z(),z=w("updateMenubar"),S=w("selectedCourses",()=>({})),U=w("selectedRows",()=>({})),A=w("isShowAdvancedSearch",()=>!1),h=N(""),m=N({value:null,filter_field:null,select_list:[],label:null}),v=w("filters",()=>({global:{value:Ae,matchMode:d.CONTAINS},option_code:{operator:i.OR,constraints:[]},course_name:{operator:i.OR,constraints:[]},chn_name:{operator:i.OR,constraints:[]},dept_chiabbr:{operator:i.OR,constraints:[]},eng_teach:{operator:i.OR,constraints:[]},generalCore:{operator:i.OR,constraints:[]},dept_code:{operator:i.OR,constraints:[]},time_inf:{operator:i.OR,constraints:[]},comment:{operator:i.OR,constraints:[]},credit:{operator:i.OR,constraints:[]}})),G=N({quick:{label:"快速搜尋",value:"quick",command:()=>f({})},advanced:{label:"進階搜尋",value:"advanced",command:()=>{A.value=!0,f({global:null})}},general:{label:"通識",value:"general",command:()=>f({option_code:{operator:i.OR,constraints:[{value:"通",matchMode:d.EQUALS}]}},{label:"選擇通識領域",select_list:Object.entries({人文藝術:"A1UG",社會科學:"A2UG",自然科學:"A3UG",邏輯運算:"A4UG",學院共同課程:"B1UG",跨域專業探索課程:"B2UG",大學入門:"B3UG",專題探究:"C1UG",MOOCs:"C2UG"}).map(([s,a])=>({label:s,value:{value:a,matchMode:d.CONTAINS}})),filter_field:"generalCore"})},physical:{label:"體育",activeLabel:"普通體育",value:"physical",command:()=>f({dept_chiabbr:{operator:i.OR,constraints:[{value:"體育",matchMode:d.CONTAINS}]}})},defense:{label:"國防",activeLabel:"全民國防教育",value:"defense",command:()=>f({chn_name:{operator:i.OR,constraints:[{value:"全民國防",matchMode:d.CONTAINS}]}})},interschool:{label:"校際",activeLabel:"臺大系統校際課程",value:"interschool",command:()=>f({dept_chiabbr:{operator:i.OR,constraints:[{value:"校際",matchMode:d.CONTAINS}]}},{label:"選擇開課學校",select_list:Object.entries({國立臺灣大學:"AA",國立臺灣科技大學:"AB"}).map(([s,a])=>({label:s,value:{value:a,matchMode:d.ENDS_WITH}})),filter_field:"dept_code"})},program:{label:"學分學程",value:"program",command:()=>f({chn_name:{operator:i.OR,constraints:[{value:"學分學程",matchMode:d.CONTAINS}]}})},english:{label:"英文三",value:"english",command:()=>f({course_name:{operator:i.OR,constraints:[{value:"英文（三）",matchMode:d.CONTAINS}]}})},emi:{label:"英文授課",value:"emi",command:()=>f({eng_teach:{operator:i.OR,constraints:[{value:"是",matchMode:d.EQUALS}]}})},"":{label:"",value:"quick",command:()=>f({})}});H(async()=>{var s,a;await q($),z.value(),h.value=((s=$.query.m)==null?void 0:s.toLowerCase())||"quick",G.value[h.value]?(a=G.value[h.value])==null||a.command():h.value="quick",S.value[O.value]||(S.value[O.value]={}),U.value=S.value[O.value]}),Q(()=>h.value,s=>{M.replace({path:$.path,query:{...$.query,m:s,s:v.value.global.value||null}})});function f(s,a=null){var t;for(const y in v.value)y!=="global"&&(y in s?v.value[y]=s[y]:(t=v.value[y]).constraints&&(t.constraints=[]));a?m.value={...m.value,value:null,filter_field:a.filter_field,select_list:a.select_list,label:a.label}:m.value.filter_field=null}function j(){A.value=!0}function D(s){const a=U.value;a[s.serial_no]?(delete a[s.serial_no],R.add({severity:"info",summary:"已取消選課",detail:`${s.serial_no} ${s.course_name}`,life:3e3})):(a[s.serial_no]=s,R.add({severity:"success",summary:"已選課",detail:`${s.serial_no} ${s.course_name}`,life:3e3}))}return(s,a)=>(n(),b(T,null,[r("div",be,[c(e(le),{value:h.value,"onUpdate:value":a[0]||(a[0]=t=>h.value=t),scrollable:""},{default:o(()=>[c(e(ee),null,{default:o(()=>[(n(!0),b(T,null,L(Object.values(G.value),t=>(n(),C(e(ae),{key:t.value,value:t.value,onClick:y=>t.command?t.command():null,class:V(t.label?"":"tab-disabled")},{default:o(()=>[p(u(h.value==t.value&&t.activeLabel||t.label),1)]),_:2},1032,["value","onClick","class"]))),128))]),_:1})]),_:1},8,["value"])]),r("div",ye,[r("div",_e,[c(e(te),{variant:"in",class:V(["search-input",m.value.filter_field?"multi-search-input-main-filter":"single-search-input"]),onClick:a[3]||(a[3]=t=>e(A)?j():null)},{default:o(()=>[c(e(J),null,{default:o(()=>[c(e(K),null,{default:o(()=>a[6]||(a[6]=[r("i",{class:"pi pi-search"},null,-1)])),_:1}),e(A)?(n(),C(e(x),{key:1,id:"globalFilter",modelValue:e(v).global.value,"onUpdate:modelValue":a[2]||(a[2]=t=>e(v).global.value=t),autocapitalize:!1,size:"large",style:{width:"100%",cursor:"pointer"}},null,8,["modelValue"])):(n(),C(e(x),{key:0,id:"globalFilter",modelValue:e(v).global.value,"onUpdate:modelValue":a[1]||(a[1]=t=>e(v).global.value=t),autocapitalize:!1,size:"large",style:{width:"100%"}},null,8,["modelValue"]))]),_:1}),e(A)?(n(),b("label",$e,"進階搜尋")):(n(),b("label",Ce,"課程名稱/教師/開課序號"))]),_:1},8,["class"]),m.value.filter_field?(n(),b("div",Oe,[c(e(se),{id:"sub-filter",modelValue:m.value.value,"onUpdate:modelValue":a[4]||(a[4]=t=>m.value.value=t),options:m.value.select_list,optionLabel:"label",optionValue:"value",style:{width:"100%"},showClear:!0,showToggleAll:!1,showFilter:!0,placeholder:m.value.label,display:"chip",onChange:a[5]||(a[5]=t=>{e(v)[m.value.filter_field].constraints=t.value||[{value:null,matchMode:e(d).CONTAINS}]})},null,8,["modelValue","options","placeholder"])])):_("",!0)]),r("div",ke,[c(e(Y),{value:e(k),paginator:!0,filters:e(v),"global-filter-fields":h.value.filter_field||e(F),showGridlines:!1,"show-headers":!1,scrollable:!0,scrollHeight:"calc(100vh - 20rem)",rows:50,rowsPerPageOptions:[10,20,50,100],loading:e(I),style:{border:"1px solid var(--p-datatable-border-color)",borderRadius:"0.5rem"}},{header:o(()=>a[7]||(a[7]=[r("span",null,"課程資訊",-1)])),loading:o(()=>[c(e(oe),{width:"100%",height:"100%",shape:"rectangle","border-radius":"0.5rem"})]),empty:o(()=>a[8]||(a[8]=[r("div",{class:"flex align-items-center justify-content-center"},[r("i",{class:"pi pi-exclamation-triangle mr-2"}),r("span",null,"沒有符合條件的課程")],-1)])),default:o(()=>[c(e(B),{sortable:!1},{body:o(({data:t})=>[c(e(ge),{course:t},null,8,["course"])]),_:1}),c(e(B),{headerStyle:{width:"5rem",textAlign:"center"},bodyStyle:{textAlign:"center"},sortable:!1,style:{width:"5rem",textAlign:"center",paddingRight:"1rem"},header:""},{body:o(({data:t})=>[c(e(X),{label:e(U)[t.serial_no]?"取消":"加入",severity:e(U)[t.serial_no]?"warn":"secondary",onClick:y=>D(t)},null,8,["label","severity","onClick"])]),_:1})]),_:1},8,["value","filters","global-filter-fields","loading"])])])],64))}};export{Le as default};
