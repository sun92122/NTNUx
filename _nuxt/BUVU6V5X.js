import{_ as T,D as y,r as N,o as z,E,F as L,v as p,A as m,G as O,H as r,y as i,z as a,B as h,I as U,x as u,J as v,C as W,K as $,L as M}from"./-6dXc0fm.js";import{u as j}from"./EXp2iaC5.js";import{_ as F}from"./DFZVcwSr.js";import P from"./j50LN05F.js";import Y from"./BnEJdqw1.js";import A from"./Ci8U2XAF.js";import G from"./D0LcweKR.js";import"./QkUgBnS3.js";import"./DQB9Y1K_.js";import"./DVMpog-_.js";import"./Bi8HgM7o.js";import"./0iwWtdD2.js";import"./D3fjSacP.js";import"./DGRLnciw.js";import"./CcbgTpcG.js";import"./BxoKn_6v.js";import"./BurOxk1n.js";const H={class:"container"},J={key:1,class:"container"},K={style:{marginBottom:0}},R={class:"card-container"},q={style:{margin:"0"}},Q={key:0,style:{"text-align":"center"}},X={key:0},Z={key:1},ee={style:{"text-align":"center"}},te={key:0},se={key:1},oe={class:"p-d-flex p-ai-center"},ne={style:{margin:"0"}},ie={style:{whiteSpace:"break-spaces",marginTop:"0.5rem"},class:"p-card-subtitle"},re={key:0,style:{"margin-top":"8rem"}},le=["href"],ae={__name:"home",setup(ce){const V=E(),{initTermData:C}=j(),D=y("updateMenubar"),I=y("routerLoading",()=>!1),o=y("courseSelectionSchedule",()=>{}),d=N(1),x=y("windowWidth",()=>window.innerWidth),S=N([{breakpoint:"100000px",numVisible:3,numScroll:1},{breakpoint:"745px",numVisible:1,numScroll:1}]);function B(){const s=new Date,t=s.getFullYear()-1911,l=s.getMonth()+1,n=s.getDate();for(const[f,c]of o.value.schedule.entries())if(c.date&&c.date.date){const[e,_,g]=c.date.date.split("/").map(Number);if(t>e||t===e&&l>_||t===e&&l===_&&n>g)continue;return f}else if(c.end&&c.end.date){const[e,_]=c.end.date.split("/").map(Number);if(l>e||l===e&&n>_)continue;return f}}function b(s,t,l){return Math.min(Math.max(s,t),l)}function w(s){d.value=b(s,0,o.value.schedule.length-3)}function k(){var t,l;const s=B();if(s!==void 0){d.value=x.value<=745?b(s,0,o.value.schedule.length-1):b(s,1,o.value.schedule.length-1)-1;const n=o.value.schedule[s];U({title:"選課時程",description:`查看選課時程並快速搜尋課程。${n.info?`${n.info} ${((t=n==null?void 0:n.date)==null?void 0:t.date)||((l=n==null?void 0:n.start)==null?void 0:l.date)||""}`:""}`,keywords:"師大課程查詢, 師大課程, 師大選課, NTNU Course Search"})}}return z(async()=>{var s;(s=o==null?void 0:o.value)!=null&&s.schedule?k():await fetch("/data/schedule.json").then(t=>t.json()).then(t=>{o.value=t,k()}).catch(t=>{console.error("Error fetching course selection schedule:",t)}),await C(V),D.value()}),L(()=>{var s,t;return(t=(s=o==null?void 0:o.value)==null?void 0:s.schedule)==null?void 0:t.length},s=>{s>0&&k()}),(s,t)=>{var l,n,f,c;return u(),p("div",H,[m(r(F)),r(I)?(u(),O(r(P),{key:0,style:{"margin-top":"30vh","margin-bottom":"20vh"}})):(u(),p("div",J,[i("h3",K,a((l=r(o))==null?void 0:l.year)+" 學年度 第 "+a((n=r(o))==null?void 0:n.term)+" 學期 ",1),t[4]||(t[4]=i("h1",{class:"center"},"選課時程",-1)),m(r(G),{value:(f=r(o))==null?void 0:f.schedule,page:d.value,numVisible:r(x)<=745?1:3,numScroll:1,showNavigators:!1,showIndicators:!1,responsiveOptions:S.value,"onUpdate:page":t[0]||(t[0]=e=>d.value=e)},{item:h(({data:e,_})=>[i("div",R,[m(r(Y),{class:"schedule-card"},{title:h(()=>[i("h3",q,a(e==null?void 0:e.info),1)]),subtitle:h(()=>[e!=null&&e.date?(u(),p("div",Q,[e.date.time?(u(),p("span",X,a(e.date.time),1)):v("",!0),i("span",{class:"card-title-date",style:$({color:e.color})},a(e.date.date),5)])):v("",!0),e.start?(u(),p("div",Z,[i("div",ee,[e.start.time?(u(),p("span",te,a(e.start.time),1)):v("",!0),i("span",{class:"card-title-date",style:$({color:e.color})},a(e.start.date)+"-"+a(e.end.date),5),e.end.time?(u(),p("span",se,a(e.end.time),1)):v("",!0)])])):v("",!0)]),content:h(()=>[m(r(A),{value:e==null?void 0:e.steps,align:"left",class:"p-mt-3"},{content:h(({item:g})=>[i("div",oe,[i("div",null,[i("h4",ne,a(g.title),1),i("div",ie,a(g.description),1)])])]),_:2},1032,["value"])]),footer:h(()=>[e!=null&&e.moreInfo?(u(),p("div",re,[i("a",{href:e.moreInfoUrl,target:"_blank",style:{color:"inherit","text-decoration":"none",cursor:"pointer"}},[t[3]||(t[3]=i("i",{class:"pi pi-external-link",style:{"margin-right":"1rem"}},null,-1)),W(" "+a(e.moreInfo),1)],8,le)])):v("",!0)]),_:2},1024)])]),_:1},8,["value","page","numVisible","responsiveOptions"]),i("div",null,[m(r(M),{icon:"pi pi-angle-left",variant:"text",rounded:"",size:"large",onClick:t[1]||(t[1]=e=>w(d.value-1)),disabled:d.value<=0,style:{"margin-right":"0.5rem"}},null,8,["disabled"]),m(r(M),{icon:"pi pi-angle-right",variant:"text",rounded:"",size:"large",onClick:t[2]||(t[2]=e=>w(d.value+1)),disabled:d.value>=((c=r(o))==null?void 0:c.schedule.length)-3},null,8,["disabled"])])]))])}}},Ve=T(ae,[["__scopeId","data-v-d315498d"]]);export{Ve as default};
